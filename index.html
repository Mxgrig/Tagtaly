<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tagtaly turns UK and US news into viral-ready intelligence. Track the surge, sentiment, and sources in one dashboard.">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <title>Tagtaly — News That Matters. Data That Shows It.</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-WZ8F7A58yxTkbZVqhlV+3I8OIVwvY74vwQ13VaeXyq5iP6k6v1zXQvQNHZJ7Y8bD" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/style.css?v=1760960007">
</head>
<body>
    <div class="app-shell">
        <!-- HEADER -->
        <header class="app-header">
            <div class="responsive-wrapper" style="display: flex; justify-content: space-between; align-items: center; width: 100%; padding: 1.5rem;">
                <div class="brand">
                    <img class="brand-logo" src="assets/taglogo.png" alt="Tagtaly logo" width="32" height="32">
                    <div>
                        <div class="brand-name">Tagtaly</div>
                        <div class="brand-tagline">News Intelligence</div>
                    </div>
                </div>
                <nav class="nav-links" style="display: none;">
                    <a href="index.html" class="nav-link active">Dashboard</a>
                    <a href="archive.html" class="nav-link">Archive</a>
                    <a href="about.html" class="nav-link">About</a>
                </nav>
                <div class="header-actions" style="display: flex; gap: 1rem;">
                    <a class="cta-btn" href="mailto:ops@tagtaly.com">Get Started</a>
                </div>
            </div>
        </header>

        <main class="app-main">
            <!-- HERO SECTION -->
            <section class="hero-section">
                <figure class="hero-image-wrapper">
                    <img id="hero-banner" src="" alt="Newsroom coverage" loading="lazy">
                    <div class="hero-overlay">
                        <div class="hero-content">
                            <h1 class="hero-title">What's Moving in News Today</h1>
                            <p class="hero-subtitle">Real-time viral trends, sentiment analysis, and editorial patterns across UK news outlets</p>
                            <div class="hero-stats">
                                <div class="stat">
                                    <span class="stat-value" id="metric-headlines">—</span>
                                    <span class="stat-label">Stories tracked</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-value" id="metric-source">—</span>
                                    <span class="stat-label">Leading source</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-value" id="metric-updated">—</span>
                                    <span class="stat-label">Updated</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </figure>
            </section>

            <!-- MAGAZINE LAYOUT -->
            <div class="article-container">
                <!-- MAIN CONTENT (3 columns) -->
                <div class="article-main">
                    <!-- Key Metrics Section -->
                    <section class="article-section">
                        <h2 class="article-title article-title--large">Today's Data Summary</h2>
                        <p>News moves fast. Newsrooms scramble to keep pace. At Tagtaly, we see everything—the stories that surge, the outlets driving coverage, the sentiment shifts happening in real-time.</p>

                        <div class="charts-grid-2">
                            <div class="chart-card">
                                <div class="card-header">
                                    <h3>News Mood</h3>
                                    <p class="card-desc">7-day sentiment trend</p>
                                </div>
                                <div class="chart-container">
                                    <div id="emotional-rollercoaster-chart"></div>
                                </div>
                            </div>
                            <div class="chart-card">
                                <div class="card-header">
                                    <h3>Momentum</h3>
                                    <p class="card-desc">Topics accelerating today</p>
                                </div>
                                <div class="chart-container">
                                    <div id="surge-alert-chart"></div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Editorial Coverage -->
                    <section class="article-section">
                        <h2 class="article-title article-title--large">What Newsrooms Are Covering</h2>
                        <p>Where are editors placing their bets? These charts show topic concentration, outlet sentiment, and the story types dominating coverage.</p>

                        <div class="charts-grid-2">
                            <div class="chart-card">
                                <div class="card-header">
                                    <h3>Weekly Winner</h3>
                                    <p class="card-desc">Top topic</p>
                                </div>
                                <div class="chart-container chart-container--compact">
                                    <div id="weekly-winner-chart"></div>
                                </div>
                            </div>
                            <div class="chart-card">
                                <div class="card-header">
                                    <h3>Tone Split</h3>
                                    <p class="card-desc">Positive vs negative</p>
                                </div>
                                <div class="chart-container chart-container--compact">
                                    <div id="media-divide-chart"></div>
                                </div>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="card-header">
                                <h3>Story Types Today</h3>
                                <p class="card-desc">Category breakdown across coverage</p>
                            </div>
                            <div class="chart-container">
                                <div id="category-dominance-chart"></div>
                            </div>
                        </div>

                        <div class="chart-card">
                            <div class="card-header">
                                <h3>Outlet Sentiment</h3>
                                <p class="card-desc">Tone by source</p>
                            </div>
                            <div class="chart-container">
                                <div id="sentiment-showdown-chart"></div>
                            </div>
                        </div>
                    </section>

                    <!-- Publishing Operations -->
                    <section class="article-section">
                        <h2 class="article-title article-title--large">Publishing Operations</h2>
                        <p>When are stories breaking? How much are outlets publishing? These metrics reveal editorial cadence and publication patterns.</p>

                        <div class="charts-grid-2">
                            <div class="chart-card">
                                <div class="card-header">
                                    <h3>Outlet Productivity</h3>
                                    <p class="card-desc">Stories published per source</p>
                                </div>
                                <div class="chart-container">
                                    <canvas id="source-productivity-chart"></canvas>
                                </div>
                            </div>
                            <div class="chart-card">
                                <div class="card-header">
                                    <h3>Publishing Rhythm</h3>
                                    <p class="card-desc">Hour-by-hour publication pattern</p>
                                </div>
                                <div class="chart-container">
                                    <div id="publishing-rhythm-chart"></div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Keywords -->
                    <section class="article-section">
                        <h2 class="article-title article-title--large">Keywords in Focus</h2>
                        <p>Language reveals intent. This word cloud shows what terms dominate coverage—from policy keywords to breaking news angles.</p>

                        <div class="chart-card">
                            <div class="card-header">
                                <h3>Top Keywords</h3>
                                <p class="card-desc">Word frequency analysis</p>
                            </div>
                            <div class="chart-container chart-container--wordcloud">
                                <div id="wordcloud-chart"></div>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- SIDEBAR (2 columns) -->
                <aside class="article-sidebar">
                    <!-- Featured Image -->
                    <div class="sidebar-card">
                        <img id="pexels-image" src="" alt="Editorial imagery" loading="lazy" style="width: 100%; height: auto; display: block;">
                    </div>

                    <!-- Today's Top Stories -->
                    <div class="sidebar-card">
                        <div class="sidebar-title">Today's Top Stories</div>
                        <div class="news-feed" id="articles-list"></div>
                    </div>

                    <!-- CTA Box -->
                    <div class="cta-box">
                        <h3>Need custom intelligence?</h3>
                        <p>Get Tagtaly integrated into your newsroom in one week.</p>
                        <a class="cta-link" href="mailto:ops@tagtaly.com">Talk to ops@tagtaly.com</a>
                    </div>
                </aside>
            </div>
        </main>

        <!-- FOOTER -->
        <footer class="app-footer">
            <div class="footer-content">
                <div class="footer-grid">
                    <div class="footer-col">
                        <h4>Tagtaly</h4>
                        <p>Enterprise news intelligence for global newsrooms. Understand what will trend before it hits prime time.</p>
                    </div>
                    <div class="footer-col">
                        <h4>Product</h4>
                        <ul>
                            <li><a href="index.html">Dashboard</a></li>
                            <li><a href="archive.html">Archive</a></li>
                            <li><a href="about.html">About</a></li>
                        </ul>
                    </div>
                    <div class="footer-col">
                        <h4>Company</h4>
                        <ul>
                            <li><a href="privacy.html">Privacy</a></li>
                            <li><a href="mailto:legal@tagtaly.com">Legal</a></li>
                            <li><a href="mailto:hello@tagtaly.com">Contact</a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-bottom">
                    <p>&copy; 2025 Tagtaly Inc. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2/dist/echarts-wordcloud.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3/dist/chart.min.js"></script>

    <!-- Data Loading & Articles -->
    <script>
        async function loadArticles() {
            try {
                const response = await fetch('assets/data/articles.json', { cache: 'no-store' });
                const data = await response.json();
                const articles = data.articles || [];

                if (articles.length === 0) {
                    document.getElementById('articles-list').innerHTML = '<p class="empty-state">No articles loaded yet.</p>';
                    return;
                }

                document.getElementById('metric-headlines').textContent = articles.length;
                const topSource = articles.length > 0 ? articles[0].source || 'Unknown' : '—';
                document.getElementById('metric-source').textContent = topSource;
                
                const now = new Date();
                document.getElementById('metric-updated').textContent = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });

                const articlesList = document.getElementById('articles-list');
                articlesList.innerHTML = '';

                articles.slice(0, 5).forEach(article => {
                    const title = article.title || article.headline || 'Untitled';
                    const source = article.source || 'Unknown';
                    const url = article.link || article.url || '#';

                    const item = document.createElement('article');
                    item.className = 'news-item';
                    item.innerHTML = `
                        <a href="${url}" target="_blank" rel="noreferrer">${title}</a>
                        <div class="news-item-meta">${source}</div>
                    `;
                    articlesList.appendChild(item);
                });
            } catch (err) {
                console.error('Error loading articles:', err);
                document.getElementById('articles-list').innerHTML = '<p class="empty-state">Error loading articles.</p>';
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadArticles);
        } else {
            loadArticles();
        }
    </script>

    <!-- Chart Rendering -->
    <script src="assets/js/social_charts.js"></script>

    <!-- Image Loading with Pexels API -->
    <script>
        const PEXELS_API_KEY = 'SyBIk8U1gkGZMT1fKmTEugxBM2PDwIePdrhegkymeJTdnxViCK20ohpy';

        async function fetchPexelsImage(searchTerm = 'news') {
            try {
                const pexelsUrl = `https://api.pexels.com/v1/search?query=${encodeURIComponent(searchTerm)}&per_page=1`;
                const response = await fetch(pexelsUrl, {
                    headers: { 'Authorization': PEXELS_API_KEY }
                });

                if (!response.ok) throw new Error(`Pexels API error: ${response.status}`);

                const data = await response.json();
                if (data.photos && data.photos.length > 0) {
                    const photo = data.photos[0];
                    return {
                        url: photo.src.landscape,
                        alt: photo.alt || `Stock photo from Pexels: ${searchTerm}`,
                        photographer: photo.photographer
                    };
                }
            } catch (error) {
                console.log('⚠️ Pexels API fetch failed:', error.message);
            }
            return null;
        }

        async function loadImages() {
            const banner = document.getElementById('hero-banner');
            if (banner) {
                banner.src = 'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?w=1600&h=600&fit=crop';
            }

            const pexelsImg = document.getElementById('pexels-image');
            if (pexelsImg) {
                const pexelsData = await fetchPexelsImage('news photography');
                if (pexelsData && pexelsData.url) {
                    pexelsImg.src = pexelsData.url;
                    pexelsImg.alt = pexelsData.alt;
                    console.log('✅ Loaded Pexels image');
                } else {
                    pexelsImg.src = 'https://images.unsplash.com/photo-1504384308090-c894fdcc538d?w=400&h=300&fit=crop';
                    console.log('📸 Using Unsplash fallback');
                }
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadImages);
        } else {
            loadImages();
        }
    </script>

    <!-- Chart Initialization -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Chart initialization starting...');
            console.log('echarts available:', typeof echarts !== 'undefined');
            console.log('Chart.js available:', typeof Chart !== 'undefined');

            // Ensure containers are properly sized
            ensureChartContainerSizes();

            // Initialize all charts
            console.log('Initializing individual charts...');
            initEmotionalRollercoaster();
            initWeeklyWinner();
            initSurgeAlert();
            initMediaDivide();
            initSentimentShowdown();
            initCategoryDominance();
            initSourceProductivity();
            initPublishingRhythm();
            initWordcloud();
            initCrossSourceStories();
            console.log('All chart init functions called');
        });
    </script>
</body>
</html>
